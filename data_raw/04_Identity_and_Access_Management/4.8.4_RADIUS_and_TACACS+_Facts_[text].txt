Security Pro 8.0

4.8.4 RADIUS and TACACS+ Facts

This lesson covers the following topics:

AAA server
RADIUS
TACACS+
AAA Server

An AAA server handles user requests for access to computer resources. A remote access server typically controls client access to remote systems. Clients might be restricted to accessing resources only on the remote access server, or they might be allowed to access resources on other hosts on the private network. Two standard AAA server solutions include RADIUS and TACACS+.

Remote access policies identify authorized users and other required connection parameters. In a small implementation, you typically define user accounts and remote access policies on the remote access server. With this configuration, you must define user accounts and policies on each remote access server. For larger deployments with multiple remote access servers, you can centralize the administration of remote access policies using an AAA server.

The remote access server receives connection requests from remote clients. It forwards them to the AAA server for approval or denial. The policies you define on the AAA server apply to all clients connected to all remote access servers.
RADIUS

Microsoft servers use RADIUS for centralized remote access administration. When using RADIUS, be aware that RADIUS:

Combines authentication, authorization, and accounting. All three must be implemented through the RADIUS system.
Allows for the separation of accounting to different servers. However, authentication and authorization remain combined on a single server.
Supports PPP, CHAP, and PAP.
Uses a challenge-response method for authentication.
Does not transmit passwords in cleartext between the RADIUS client and the RADIUS server.
A shared secret is used between the RADIUS server and the RADIUS client.
The password is hashed, and the hash is added before it is transmitted.
Encrypts only the password using MD5.
Uses UDP ports 1812 and 1813 and can be vulnerable to buffer overflow attacks.
Often uses vendor-specific extensions. RADIUS solutions from different vendors might not be compatible.
For example, a NAS device (RADIUS client) is configured with the IP address of the RADIUS server and a shared secret. This allows the client to authenticate to the server. Remember that the client is the access device (switch, access point, or VPN gateway), not the user's PC or laptop. A generic RADIUS authentication workflow proceeds as follows:

The user's device (the supplicant) connects to the NAS appliance, such as an access point, switch, or remote access server.
The NAS prompts the user for their authentication credentials. RADIUS supports PAP, CHAP, and EAP. Most implementations now use EAP, as PAP and CHAP are not secure. If EAP credentials are required, the NAS enables the supplicant to transmit EAP over LAN (EAPoL) data but not any other type of network traffic.
The supplicant submits the credentials as EAPoL data. The RADIUS client uses this information to create an Access-Request RADIUS packet, encrypted using the shared secret. It sends the Access-Request to the AAA server using UDP on port 1812 (by default).
The AAA server decrypts the Access-Request using the shared secret. If the Access-Request cannot be decrypted (because the shared secret is not correctly configured, for instance), the server does not respond.
With EAP, Access-Challenge and Access-Request packets will be exchanged as the authentication method is set up and the credentials verified. The NAS acts as a pass-thru, taking RADIUS messages from the server and encapsulating them as EAPoL to transmit to the supplicant.
At the end of this exchange, if the supplicant is authenticated, the AAA server responds with an Access-Accept packet; otherwise, an Access-Reject packet is returned.
Optionally, the NAS can use RADIUS for accounting (logging). Accounting uses port 1813. The accounting server can be different from the authentication server.
TACACS+

TACACS+ was originally developed by Cisco for centralized remote access administration. TACACS+:

Provides three protocols, one each for authentication, authorization, and accounting. This allows each service to be provided by a different server.
Uses TCP port 49.
Encrypts the entire packet contents, not just authentication packets. The client-server dialogs are also encrypted.
Supports more protocol suites than RADIUS.
Requires remote access servers to become TACACS+ clients to the backend TACACS+ server, like a RADIUS solution.
TACACS was initially developed in 1984 by BBN Technologies. The protocol standard, TACACS+, was developed by Cisco Systems but is supported by many vendors, such as BlueCat Networks, IBM, Netgear, and more.

TACACS and Extended Terminal Access Controller Access-Control System (XTACACS) are older protocols developed before TACACS+. While they sound similar, they are different and less secure protocols.
