Security Pro 8.0

8.1.2 Hardening Facts

This lesson covers the following topics:

Operating system security
Workstations
Installing endpoint protection
Patch management
OS hardening best practices
Encryption techniques
Operating System Security

Operating system security encompasses many practices that aim to protect against unauthorized access, data breaches, malware infections, and other security threats. There are many considerations and requirements when securing an operating system because operating systems are complicated and powerful software products operating at the core of all information systems. Many security concepts apply to operating system security, including access controls, authentication mechanisms, secure configurations, application security, secure coding, patch management, endpoint protection, user awareness training, and monitoring.

Hardening describes changing an operating system or application to make it operate securely. The need for hardening must be balanced against functional requirements and usability because hardening can often negatively impact how applications work or interoperate.

Best practice baselines play a critical role in device hardening by providing a standard set of guidelines or checklists for configuring devices securely. These baselines, often developed by cybersecurity experts or organizations, offer a starting point for systems administrators to ensure that devices are configured according to industry security standards. Many of the requirements can be applied automatically via a configuration baseline template. The essential principle is of least functionality; that a system should run only the protocols and services required by legitimate users and no more. This reduces the potential attack surface.

Interfaces provide a connection to the network. Some machines may have more than one interface. For example, there may be wired and wireless interfaces or a modem interface. Some machines may come with a management network interface card. If any of these interfaces are not required, they should be explicitly disabled rather than simply left unused.
Services provide a library of functions for different types of applications. Some services support local features of the OS and installed applications. Other services support remote connections from clients to server applications. Unused services should be disabled.
Application service ports allow client software to connect to applications over a network. These should be disabled or blocked at a firewall if remote access is not required. Be aware that a server might be configured with a nonstandard port. For example, an HTTP server might be configured to use 8080 rather than 80. Conversely, malware may try to send nonstandard data over an open port. An intrusion detection system should detect network data that does not conform to the expected protocol format.
Persistent storage holds user data generated by applications, plus cached credentials. Disk encryption is essential to data security. Self-encrypting drives can be used so that all data at rest is always stored securely.
It is also important to establish a maintenance cycle for each device and keep up to date with new security threats and responses for the particular software products that you are running.
Workstations

Workstations operate at the frontline of an organization's activities and present unique concerns regarding endpoint hardening compared to other devices. Due to the varied tasks and numerous applications associated with workstation use, they generally have a large attack surface. Hardening practices to minimize this attack surface include removing unnecessary software, limiting administrative privileges, strictly managing application installations and updates, and many other changes. Furthermore, since employees operate workstations, user-focused security strategies are essential, including regular training and awareness activities to educate users about threats such as phishing and promoting secure behaviors such as strong password practices, responsible Internet use, and careful handling of sensitive data, among other practices.

Additionally, configuring workstation settings for increased security, like automatic updates, screen locks, firewalls, endpoint protection, intrusion detection and prevention, increased logging, encryption, monitoring, and many other protections, are essential. Also, the need to secure peripheral devices like USB ports is unique to workstations. It is often achieved using features of endpoint protection software and the implementation of strict device control policies. Lastly, given the various roles and responsibilities assigned to different workstations, segmentation is crucial to restrict communications and limit the potential for malware or attackers to propagate across the network.
Installing Endpoint Protection

To ensure maximum protection and efficient management, deploying and managing endpoint protection agents on workstations, laptops, and servers in an enterprise environment requires strategic planning and adherence to established best practice configuration and management practices.

Create a deployment plan with considerations such as the deployment order (such as which devices or departments get agents first), time frames, and leveraging stages to limit potential disruptions caused by endpoint protection settings.
Standardize configurations for endpoint protection across all devices to ensure consistency in protection levels and simplify compliance management.
Automate deployments using tools like Microsoft's System Center Configuration Manager (SCCM), Group Policy, or third-party solutions to save time, improve consistency, and reduce the risk of human error.
Updates and patches to endpoint protection agent software and definitions are required to ensure the highest levels of protection against the latest known threats.
Monitor endpoint protection agents to check for alerts or signs of potential security incidents, verify that agents are running, and ensure that updates and patches are applied successfully.
Centralize management to provide a comprehensive view of endpoint configurations, updates, and status. Centralized management also allows administrators to enforce global security policies.
Patch Management

No operating system, software application, or firmware implementation is free from vulnerabilities. As soon as a vulnerability is identified, vendors will try to correct it. At the same time, attackers will try to exploit it. Automated vulnerability scanners can effectively discover missing patches for the operating system, plus a wide range of third-party software apps and devices/firmware. Scanning is only useful if effective procedures are i n place to apply the missing patches.

In residential and small networks, hosts are typically configured to auto-update, meaning they check for and install patches automatically. The major OS and applications software products are well supported in terms of vendor-supplied fixes for security issues. In Windows, this process is handled by Windows Update, while in Linux, it can be configured via yum-cron or apt unattended upgrades , depending on the package manager used by the distribution.

There can also be performance and management issues when multiple applications run update clients on the same host. For example, as well as the OS updater, there is likely also a security software update, browser updater, Java updater, OEM driver updater, and so on. These issues can be mitigated by deploying an enterprise patch management suite. Some suites, such as Microsoftâ„¢ System Center Configuration Manager (SCCM)/Endpoint Manager (docs.microsoft.com/en-us/mem/configmgr), are vendor-specific, while others are designed to support third-party applications and multiple OSes.

Testing patches before deploying them into the production environment is crucial for maintaining the stability and security of software. By conducting thorough testing, organizations can identify potential issues or conflicts arising from the patch, ensuring that it does not introduce new vulnerabilities or disrupt critical operations. Testing helps mitigate the risk of unintended consequences and facilitates a more controlled deployment process, ultimately safeguarding the integrity and reliability of the environment. Testing is typically performed in testing environments built to mirror the production environment as much as appropriate.

Patch management can be difficult for legacy systems, proprietary systems, and systems from vendors without robust security management plans, such as some types of Internet of Things devices. These systems will need compensating controls or some other form of risk mitigation if patches are not readily available.
OS Hardening Best Practices

Different hardening approaches are required to protect endpoints in response to varied and constantly evolving cybersecurity threats. These threats require a layered and comprehensive defense strategy addressing vulnerabilities at multiple levels, from physical access to network protocols, operating system configurations, and user behaviors.

Technique
Definition
Access controls	
Access control refers to regulating and managing the permissions granted to individuals, software, systems, and networks to access resources or information. Access controls ensure that only authorized entities can perform specific actions or access certain data, while unauthorized entities are denied access. Access control concepts apply to networks, physical access, data, applications, and the cloud.

Access control lists (ACLs) in computer systems and networks are used to enforce access control policies. An ACL is a list of rules or entries that specify which users or groups are allowed or denied access to specific resources or perform certain actions. In networks, ACLs are associated with routers, firewalls, or similar devices and define rules that determine how network traffic is filtered or forwarded based on criteria like source IP addresses, destination IP addresses, ports, or protocols.

ACLs can help to control network access and protect against unauthorized or malicious activities. ACLs control access to files, directories, or system resources in operating systems and file systems. Each access control entry (ACE) typically contains a user or group identifier and associated permissions controlling actions that are allowed or denied. These permissions often include read, write, execute, and sometimes more granular limits such as modify, delete, or list.

While ACLs offer flexibility and control, managing complex access control policies with numerous ACL entries can become challenging. Complexity increases the risk of misconfigurations. Therefore, proper planning, periodic reviews, and best practice configurations are essential when implementing and maintaining ACLs.
Principle of least privilege	
Implementing the principle of least privilege (PoLP) is a cornerstone of improving endpoint protection and minimizing the risk of security issues. The principle of least privilege dictates that users, applications, and processes should only be granted the minimum permissions necessary to complete their duties and nothing more.

There are several practical methods for implementing least privilege. An essential first step to effectively implementing least privilege is thoroughly auditing user roles, privileges, and responsibilities. This process allows organizations to understand what access each user needs to perform their job role effectively. Access controls and permissions can be adjusted to adopt a principle of least privilege that best reflects the audit results.

The principle of least privilege also applies to software applications and operating systems, not just to users. For instance, ensuring that applications run with the minimum necessary permissions can prevent them from being exploited to carry out privileged actions.
Application allow lists and block lists	
One element of endpoint configuration is an execution control policy that defines applications that can or cannot be run.

An  allow list (or approved list) denies execution unless the process is explicitly authorized.
A  block list (or deny list) generally allows execution but explicitly prohibits listed processes.
The contents of allow lists and block lists need to be updated in response to incidents and ongoing threat hunting and monitoring.

Threat hunting may also provoke a strategic change. For example, if you rely principally on explicit denies, but your systems are subject to numerous intrusions, you will have to consider adopting a "least privileges" model and using a deny-unless-listed approach. This sort of change can be highly disruptive, however, so it must be preceded by a risk assessment and business impact analysis.
Monitoring	
Monitoring plays a vital role in endpoint hardening, helping to enforce and maintain the security measures put in place during the hardening process. Once devices are hardened, monitoring helps to ensure these conditions remain in place.

Security analysts can detect changes that weaken the hardened configuration through continuous monitoring. For instance, if a previously disabled port is detected as open or a service that was disabled is changed to enabled, monitoring tools can alert analysts of the change, which may indicate a breach.

Additionally, monitoring can provide valuable data for compliance and auditing purposes. Regular reports on the status of endpoint devices can verify that hardening baselines have been effectively deployed and maintained, supporting compliance with various regulations and industry standards.
Configuration enforcement	
Configuration enforcement describes methods used to ensure that systems and devices within an organization's network adhere to mandatory security configurations. Configuration enforcement generally depends upon a few important capabilities.

Standardized configuration baselines are defined by organizations like NIST, CIS, or the organization itself and used as the benchmark for how systems and devices should be configured.
Automated configuration management tools are used to apply and maintain standardized configuration baselines across the environment automatically.
Continuous monitoring and compliance checks are crucial to detect deviations from mandatory configurations.
Change management processes ensure configuration changes are properly reviewed, tested, and approved before implementation.
Decommissioning	
Decommissioning processes play a vital role in supporting security within an organization. When a device is no longer needed, it often contains residual data, potentially sensitive information, and system configurations that could be exploited. A thorough and systematic decommissioning process ensures that all data is securely erased or overwritten to reduce the risk of exposure. Decommissioning also involves resetting devices to their factory settings and eliminating any residual settings. Updating inventory records during decommissioning is also important to maintain an accurate account of active assets and support compliance requirements that mandate accurate asset tracking and secure disposal.
Changing defaults and removing unnecessary software	
Changing default passwords and removing unnecessary software are two fundamental practices in hardening an endpoint to strengthen its security posture. Default passwords, often set by manufacturers, are widely known and easily discoverable, making devices that use them particularly vulnerable to unauthorized access. Therefore, changing these passwords to strong, unique credentials is crucial as part of the initial setup process for any device or system.

Removing unnecessary software is another critical step when hardening an endpoint. Each software application introduces potential vulnerabilities that malicious actors could exploit. The attack surface is significantly reduced by reducing the number of software applications to only those necessary for the device's intended function. This includes removing unnecessary applications and disabling unnecessary features or services within the remaining applications. This practice simplifies the maintenance and patch management process because there are fewer applications to update, reducing the chances of missing a critical security patch.
Encryption Techniques

Endpoint encryption is critical to protecting sensitive data, especially in an enterprise setting. Several different approaches are required to protect data on endpoints. Some important ones include the following:

Full Disk Encryption (FDE) encrypts the entire hard drive of a device. It ensures that all data, including the operating system and user files, are protected even while the operating system is not running. Tools like BitLocker for Windows and FileVault for macOS provide full disk encryption capabilities.
Removable Media Encryption ensures that data remains protected even when physically removed from devices such as SDCards or USB mass storage devices. Many FDE tools also include options for encrypting removable media.
Virtual Private Networks (VPNs) complement endpoint encryption by providing a secure tunnel for data transmission that protects against eavesdropping, on-path, and many other attack types.
Email Encryption protects sensitive information stored in emails using protocols like PGP (Pretty Good Privacy) or S/MIME (Secure/Multipurpose Internet Mail Extensions).
