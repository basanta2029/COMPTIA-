Transcript




close interactive script
Click one of the buttons to take you to that part of the video.
1. Hardening Applications on Linux
00:04
In this demonstration, we're going to look at how to
00:06
harden applications or services on a Linux system.
00:09
There are several different services you
00:10
can use to harden applications or services.
00:13
One of them is called SELinux.
00:15
It's a cool access control security feature.
2. SELinux
00:18
Essentially, the idea behind SELinux is that you
00:21
use the operating system kernel to limit what a
00:23
particular application is allowed to do, and it goes
00:26
beyond the limitations that you set with permissions
00:28
or privileges based on the user account.
00:31
Think of it as a roadblock to help
00:33
prevent hackers from doing more damage.
00:36
SELinux can be set to determine access between users,
00:39
files, directories, memory, ports, and sockets.
00:42
First, we're going to type ‘sestatus'.
00:45
this will tell us if SELinux is enforcing the system.
00:49
Next, we'll take a look at the SELinux
00:51
config file located in ‘/etc/selinux/config'.
00:56
This config file sets the permanent state of SELinux.
01:00
It's recommended to set your system to permissive
01:02
first, install all your needed applications, and then
01:06
view the logs to make the necessary changes to SELinux.
01:09
The permissive setting logs all the permission
01:12
denied errors while allowing an application to run.
01:15
Any changes to the SELinux config file located
01:18
in /etc/selinux/config requires a reboot.
01:24
Two places we can look for SELinux permission
01:26
denied errors are in the audit log and journalctl.
01:30
Let's take a look at the audit log,
01:31
‘less /var/log/audit/audit.log'.
01:39
We're going to use a question mark and search
01:41
for ‘AVC', which is a type of SELinux error.
01:45
As you can see, there's some denied messages from
01:47
other applications that we should probably look at.
01:50
Let's exit out of here and look at ‘journalctl'.
01:53
SELinux errors may be in red if
01:57
there's a problem to address.
01:58
We don't have much time to search through the logs right
02:00
now, but this should give you a good idea of where to look.
02:04
If a service is unable to start, it might
02:06
cause SELinux to deny permission to certain
02:08
aspects that allow the application to run.
02:11
When you need to determine the cause
02:12
of a problem, logs are your friend.
02:15
Let's type ‘clear' to clear our screen.
3. Booleans
02:18
By default, SELinux has hundreds of Booleans that are
02:21
essentially off and on switches for certain tasks.
02:24
To view the whole list of Booleans, type ‘getsebool -a'.
02:29
Let's say I only want to see Booleans related to samba.
02:32
Let's type ‘getsebool -a | grep samba'.
02:37
To enable a Boolean, we can use the setsebool command.
02:42
There's one in particular that we
02:44
want to enable called samba_share_nfs.
02:48
This one grants samba rights to export NFS volumes.
02:53
To set this, type ‘setsebool samba_share_nfs 1 -P'.
03:02
Now, if we go back and type ‘getsebool -a | grep
03:07
samba', you'll see that samba_share_nfs is set to On.
4. Context Types
03:12
When SELinux is enforced, it uses a
03:15
categorization system called context types.
03:18
These are labels with addition information
03:20
related to its purpose, user, role, and such.
03:23
Today, we're just going to cover the basics.
03:26
One useful command you can use to
03:28
view the context type is the -Z flag.
03:31
Let take a look at the context types
03:34
for the samba configuration folder.
03:35
Type ‘ls -lZ /etc/samba'.
03:43
As you can see, there's additional information
03:45
listed here that gives a label to samba so SELinux
03:48
knows these are samba configuration files.
03:51
If a configuration file was made in a /home directory
03:55
and then copied to an /etc config directory, it may
03:59
not have the right context type when copied.
04:01
This could prevent applications from working correctly
04:04
and show a denied message from SELinux in the logs.
5. Summary
04:08
And that's it for this demonstration.
04:10
In this demo, we looked at hardening
04:12
Linux applications using SELinux.
04:15
We talked about how SELinux can protect
04:17
your system using access control security.
04:20
Then we saw some of the commands for managing SELinux and
04:23
how to troubleshoot permission denied errors from SELinux.