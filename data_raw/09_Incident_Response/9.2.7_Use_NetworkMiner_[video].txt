Transcript




close interactive script
Click one of the buttons to take you to that part of the video.
1. Use NetworkMiner
00:04
NetworkMiner is a Network Forensic Analysis Tool.
00:07
It is able to take a PCAP file and analyze
00:10
it for clues about the hosts and protocols
00:13
on the network at the time of the capture.
2. Load PCAP File
00:16
To open NetworkMiner in Security Onion, go
00:19
to Applications, Other and then NetworkMiner.
00:27
Once it opens, go to file open and then
00:29
choose the pcap file that you want to analyze.
00:33
NetworkMiner will then automatically analyze the
00:36
file and present the information in a series of tabs.
3. Viewing Hosts
00:39
The first tab is the hosts tab.
00:42
This tab will list all of the unique hosts by
00:44
IP addresses that were found in the PCAP file.
00:48
Each host can be opened by clicking on the
00:51
plus sign next to it revealing the information
00:53
about the host that NetworkMiner knows.
00:56
For example, if I open 172.28.24.3 I will get it's IP,
01:03
MAC Address, information about the number of packets it
01:07
sent and received, and any details about the host.
01:10
In this case, if I click on the Host Details, I will
01:13
see the User-Agent string of the browser the host used.
01:18
In the next tab, you will find the files that were
01:20
transferred between hosts during the packet capture.
01:24
Right-clicking on a file will allow you to
01:26
open the file or calculate the file's hash.
01:29
For this capture, I created a fake
01:31
virus using the EICAR test string.
01:34
This string when placed in a file will
01:36
be detected as a virus by most vendors.
01:39
I can choose to open the folder where the virus.exe is
01:43
stored and then open it using gedit to show the EICAR string.
4. Compare Hashes
01:48
I can also use the file hash feature to compare the file
01:52
to known bad file hashes using tools like VirusTotal.
01:55
First right-click on the file and
01:58
choose Calculate MD5/SHA1/SHA256 hash.
02:04
Next highlight the hash you want to compare
02:06
and press CTRL+C to copy it to the clipboard.
02:16
In a web browser, open VirusTotal.com
02:20
and click on the Search link.
02:21
Then paste the hash into the search box and press enter.
02:26
This will then compare the hash
02:28
against known malicious files.
02:30
In this case, it will be an EICAR test file that
02:33
most antivirus manufacturers will mark as a virus.
5. Additional Features
02:37
Another tab of interest is the credentials tab.
02:41
Here any clear text credentials like
02:44
telnet, FTP, or HTTP will be shown.
02:47
In this capture, there was an FTP
02:50
session that we have the credentials for.
02:52
The sessions tab shows the unique
02:54
conversations between hosts.
02:56
Any DNS queries and responses that are
02:59
captured will be decoded in the DNS tab.
03:01
The parameters tab shows many potential key-value
03:05
pairs that may have important information.
03:07
Finally, NetworkMiner provides the ability
03:11
to search a PCAP file for certain keywords.
03:14
You can do this by clicking on Keywords.
03:17
Next add a keyword and follow the
03:20
instruction to reload the case file.
03:21
The display will now show all of the
03:24
packets that include the keyword.
6. Summary
03:26
That's it for this demo.
03:28
In this demo we used NetworMiner to view
03:31
the contents of a captured PCAP file.