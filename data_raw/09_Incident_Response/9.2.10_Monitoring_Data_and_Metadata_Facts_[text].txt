Security Pro 8.0

9.2.10 Monitoring Data and Metadata Facts

This lesson covers the following topics:

Log data
Metadata
Data analyzers
Log Data

Log data is a critical resource for investigating security incidents. As well as the log format, you must also consider the range of sources for log files and know how to determine the type of log file that best supports any given investigation scenario.

Event data is generated by processes running on network appliances and general computing hosts. The process typically writes its event data to a specific log file or database. Each event is comprised of message data and metadata:

Event message data is the specific notification or alert the process raises, such as "Login failure" or "Firewall rule dropped traffic."
Event metadata is the source and time of the event. The source might include a host or network address, a process name, and categorization/priority fields.
Accurate logging requires synchronization of each host to the same date, time value, and format. Ideally, each host should also be configured to use the same time zone or a "neutral" zone, such as universal coordinated time (UTC).

Windows hosts and applications can use Event Viewer format logging. Each event has a header reporting the source, level, user, timestamp, category, keywords, and hostname.

Syslog provides an open format, protocol, and server software for logging event messages. It is used by a vast range of host types. For example, syslog messages can be generated by switches, routers, firewalls, and UNIX or Linux servers and workstations.

A syslog message comprises a PRI code, a header, and a message part:

The PRI code is calculated from the facility and severity level.
The header contains a timestamp, hostname, app name, process ID, and message ID fields.
The message part contains a tag showing the source process plus content. The format of the content is application-dependent. It might use space- or comma-delimited fields or name/value pairs.
Metadata

File metadata is stored as attributes. The file system tracks when a file was created, accessed, and modified. A file might be assigned a security attribute, marking it as read-only or a hidden or system file. The ACL attached to a file showing its permissions represents another attribute. Finally, the file may have extended attributes recording an author, copyright information, or tags for indexing/searching.

As metadata is uploaded to social media sites, they can reveal more information than the uploader intended. Metadata can include current location and time, which is added to media such as photos and videos.

Metadata is produced by almost all network activity. Server requests, applications, and email are examples of where metadata can be found. In the context of bandwidth monitors, metadata is used to investigate security-related concerns or incidents. The following table describes three types of metadata.

Type	Description
Email metadata	Email provides metadata that is used to trace email. All emails come with a header containing information about the sender and recipient. Parts of the headers can be spoofed, giving investigators false information. However, there are security devices that put X-headers throughout an email's header. These provide the originating email account and IP address, not the spoofed one.
Mobile metadata	Tablets, laptops, smartphones, smartwatches, and any other device that connects to the internet and can be moved around produces mobile metadata. These devices send emails, text messages, and use apps. All these produce metadata that can be used to identify people, places, times, and even deleted data. Pictures can be timestamped and geolocation stamped. Much of this metadata also reveals the origination of the data and the sender.
Web metadata	Websites produce many types of metadata. The metadata on a user's machine versus the server can differ greatly. The data on both sides of the transmission can help fill in gaps and corroborate findings. Metadata includes IP addresses, user requests, downloads, time spent on the site, and attempts to gain unauthorized access. Web metadata includes cookies, browser history, and cached pages. Many times, malicious actors will attempt to obfuscate their metadata. However, there are ways of finding the actual metadata, especially for trained forensic investigators.
Data Analyzers

Network admins should always look for a way to examine what is happening inside the network. There are several tools to help sift through the tremendous amounts of data generated by network activity. The following table describes some of these tools.

Tool	Description
NetFlow	NetFlow is a feature on Cisco routers. It works at layers 2 – 4. It can examine each data flow that comes through the network or be set to sample sessions at specific intervals.
sFlow	sFlow is a packet sampling technology that works on layers 2 – 7. Unlike NetFlow, sFlow can only be used in sampling mode. This is a stateless packet sampling that provides information on various layers and does it quickly and efficiently.
IPfix	IPfix directly integrates data that usually goes to Syslog or SNMP. This eliminates additional services collecting data from each network device. IPfix has provisions for variable length fields, meaning there are no ID number restrictions. IPfix addresses the need for a standardized protocol for internal protocol flows. This data comes from routers, servers, and other network appliances that are mediation systems. The data is formatted, sent to an exporter, and then sent to a collector. IPfix, like NetFlow, looks at flow and the number of packets sent and received during a given session.
