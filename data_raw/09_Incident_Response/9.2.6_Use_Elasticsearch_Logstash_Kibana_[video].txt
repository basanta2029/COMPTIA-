Transcript




close interactive script
Click one of the buttons to take you to that part of the video.
1. Elasticsearch Logstash Kibana (ELK)
00:04
In this demo, we use the Elasticsearch Logstash
00:08
Kibana (ELK) stack to store and search security logs
00:12
created by other tools in Security Onion such as Zeek.
00:17
We'll use Kibana to review sample logs.
00:20
Security Onion is a free and open source Linux
00:23
distribution for threat hunting, enterprise
00:26
security monitoring, and log management.
00:29
It includes Elasticsearch, Logstash, Kibana, Snort,
00:33
Suricata, Zeek (formerly known as Bro), Wazuh, Sguil, Squert,
00:39
CyberChef, NetworkMiner, and many other security tools.
2. ELK Startup
00:44
First, we click the Kibana link
00:47
on the Security Onion desktop.
00:49
By default, Security Onion uses
00:52
a self-signed TLS certificate.
00:54
We tell Chromium to allow us to proceed
00:56
by clicking Advanced and then proceed.
00:59
On a production system, it would be advisable
01:02
to install a valid TLS certificate and use the
01:05
fully qualified name instead of localhost.
01:09
The username and password for Security
01:11
Onion are set during the initial setup.
01:14
In this case, we set up a user in
01:16
the Security Operations Center (SOC).
01:18
We'll login as that user.
3. Network Intrusion Detection System (NIDS) logs
01:21
After logging in, Kibana defaults to the dashboard page.
01:25
This could be used as a dashboard for a SOC
01:37
or as the starting point for a threat hunter.
01:39
In this case, we want to look at the Network Intrusion
01:43
Detection System (NIDS) logs, so we click NIDS to drill down.
01:50
Here we notice a classification of Attempted Administrator
01:53
Privilege Gain that we want to look at further.
01:57
To do that, we hover on that line and click
02:00
the magnifying glass with the plus sign.
02:03
This adds it as a filter.
02:05
To keep the filter as we pivot to other parts
02:08
of Kibana, we click Actions and pin the filter.
02:12
Next, we click Discover to see
02:14
the logs that match the filter.
02:16
Notice how the filter has stayed
02:18
with us because we pinned it.
02:20
Now we can see each log entry that matched our filter.
02:24
Notice that the timestamp and other
02:26
information about the alert is listed.
02:29
You can view more information for an event by
02:31
clicking the arrow to the left of the time stamp.
02:34
From the description, we can also search for
02:37
more information about the signature listed.
02:40
We do this by highlighting it, right-clicking,
02:43
and choosing to search for it using Google.
02:46
Some signatures are based on Common
02:48
Vulnerabilities and Exposures (CVEs).
02:50
CVEs describe potential security issues
02:55
with certain software or hardware.
02:58
They provide a common language to evaluate the risk posed.
03:02
By typing CVE into the search field, you can focus
03:06
the results on signatures that are tied to a CVE.
03:09
Researching the CVE can help you determine whether
03:12
the attempt against the asset could be successful.
4. Zeek
03:15
Let's look at one more example.
03:18
But first, let's clear our pinned criteria
03:21
by going to Actions and clicking Remove.
03:24
We also need to remove the search term CVE.
03:28
Once this is done, we'll go back to the dashboard.
03:32
Under Zeek Hunting, click HTTP to list
03:35
alerts relating only to the HTTP protocol.
03:40
Now we can look at the events based on the
03:42
HTTP status messages and the methods used.
03:46
Using the same technique with the magnifying glass
03:48
as before, let's drill into the Forbidden messages.
03:53
Again, we want to pin the filter so that
03:55
it stays with us as we move through Kibana.
03:59
Notice that this time we are using
04:00
a different way to pin the filter.
04:03
This method allows you to pin or unpin
04:05
individual filters instead of all filters.
04:09
In the details of one of the events, we can see the Uniform
04:12
Resource Identifier (URI) that the attacker tried to access.
04:17
We can also see the user agent of the attacker.
04:20
In this case, our attacker didn't mask the
04:23
fact that a common tool for finding website
04:26
vulnerabilities called Nikto was being used.
5. Summary
04:30
That's it for this demo.
04:31
In this demo we went over a few of the ways
04:34
the power of Elasticsearch can be harnessed
04:36
to help the security professional.