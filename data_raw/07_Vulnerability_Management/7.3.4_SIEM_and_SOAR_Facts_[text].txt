Security Pro 8.0

7.3.4 SIEM and SOAR Facts

This lesson covers the following topics:

Security Information and Event Management (SIEM)
Alerting and monitoring activities
Alerting
Reporting
Archiving
Alert tuning
Security Information and Event Management (SIEM)

Software designed to manage security data inputs and provide reporting and alerting is often described as security information and event management (SIEM). The core function of a SIEM tool is to collect and correlate data from network sensors and appliance/host/application logs. In addition to logs from Windows and Linux-based hosts, this could include switches, routers, firewalls, IDS sensors, packet sniffers, vulnerability scanners, malware scanners, and data loss prevention (DLP) systems.

Collection is how the SIEM ingests security event data from various sources. There are three main types of security data collection:

Agent-based —this approach means installing an agent service on each host. As events occur on the host, logging data is filtered, aggregated, and normalized at the host and then sent to the SIEM server for analysis and storage. Collection from Windows/Linux/macOS computers will use agent-based collection. The agent must run as a process and could use 50–500 MB of RAM, depending on the amount of activity and processing it does.
Listener/collector —rather than installing an agent, hosts can be configured to push log changes to the SIEM server. A process runs on the management server to parse and normalize each log/monitoring source. This method is often used to collect logs from switches, routers, and firewalls, as these are unlikely to support agents. Some variant of the Syslog protocol is typically used to forward logs from the appliance to the SIEM.
Sensor —as well as log data, the SIEM might collect packet captures and traffic flow data from sniffers. A sniffer can record network data using either a switch's mirror port functionality or some tap on the network media.
As distinct from collection, log aggregation refers to normalizing data from different sources to be consistent and searchable. SIEM software features connectors or plug-ins to interpret (or parse) data from distinct types of systems and to account for differences between vendor implementations. Each agent, collector, or sensor data source will require its own parser to identify attributes and content that can be mapped to standard fields in the SIEM's reporting and analysis tools. Another essential function is normalizing date/time zone differences to a single timeline.
Alerting and Monitoring Activities

When data has been collected and aggregated, the SIEM can implement alerting, reporting, and archiving activities. Note that these activities can be performed manually or automated using discrete tools for each security appliance. The advantage of a SIEM is to consolidate the activities into a single management interface. This consolidated functionality, referred to as a "single pane of glass," refers to the enhanced visibility into a complex environment that such software offers.
Alerting

Correlation means interpreting the relationship between individual data points to diagnose incidents of significance to the security team. A SIEM correlation rule is a statement that matches certain conditions. These rules use logical expressions, such as AND and OR, and operators, such as == (matches), < (less than), > (greater than), and in (contains). For example, a single-user login failure is not a condition that should raise an alert. Multiple user login failures for the same account, taking place within one hour, are more likely to require investigation and are a candidate for detection by a correlation rule.

Note:
Error.LoginFailure > 3 AND LoginFailure.User AND Duration < 1 hour
As well as the correlation between indicators observed in the collected data, a SIEM will likely be configured with a threat intelligence feed. This means that data points observed in the collected network data can be associated with known threat actor indicators, such as IP addresses and domain names.

Each alert will be dealt with by the incident response processes of analysis, containment, eradication, and recovery. When used in conjunction with a SIEM, two steps in alert response and remediation deserve particular attention:

Validation during the analysis process is how the analyst decides whether the alert is a true positive and needs to be treated as an incident. A false positive generates an alert, but no actual threat activity exists.
Quarantine isolates the source of indicators, such as a network address, host computer, or file.
Alert response and remediation steps will often be guided by a playbook that assists the analyst with applying all incident response processes for a given scenario. One of the advantages of SIEM and advanced security orchestration, authorization, and reporting (SOAR) solutions is to automate validation and remediation fully or partially. For example, a quarantine action could be available as a mouse-click action via an integration with a firewall or endpoint protection product. Validation is made easier by correlating event data to known threat data and pivoting between sources, such as inspecting the packets that triggered a particular IDS alert.
Reporting

Reporting is a managerial control that provides insight into the security system's status. A SIEM can assist with reporting activity by exporting summary statistics and graphs. Report formats and contents are usually tailored to meet the needs of different audiences:

Executive reports provide a high-level summary for decision-makers. This guides planning and investment activity.
Manager reports provide cybersecurity and department leaders with detailed information. This guides day-to-day operational decision-making.
Compliance reports provide whatever information is required by a regulator.
Determining which metrics are most useful for reporting is always very challenging. The following types illustrate some common use cases for reporting:
Authentication data, such as failed login attempts and critical file audit data.
Hosts with missing patches and/or configuration vulnerabilities.
Privileged user account anomalies include out-of-hours use or excessive requests for elevated permissions.
Trend reporting to show changes to key metrics over time.
A SIEM can be used for two types of reporting:
Alerts and alarms detect the presence of threat indicators in the data and can be used to start incident cases. Day-to-day management of alert reporting forms a large part of an analyst's workload.
Status reports communicate data about the level of threat or number of incidents being raised and the effectiveness of security controls and response procedures. This type of reporting can be used to inform management decisions. It might also be required for compliance reporting.
A SIEM will ship with several preconfigured dashboards and reports, but it will also make tools available for creating custom reports. It is critical to tailor the information presented in a dashboard or report to meet the needs and goals of its intended audience. If the report contains an overwhelming amount of data or irrelevant information, it will not be possible to identify remediation actions quickly.
Archiving

A SIEM can enact a retention policy to keep historical log and network traffic data for a defined period. This allows for retrospective incident and threat hunting and can be a valuable source of forensic evidence. It can also meet compliance requirements to hold archives of security information. SIEM performance will degrade if excessive data is kept available for live analysis. A log rotation scheme can be configured to move outdated information to archive storage.
Alert Tuning

Correlation rules are likely to assign a criticality level to each match. Examples include the following:

Log only — an event is produced and added to the SIEM's database, but it is automatically classified.
Alert — the event is listed on a dashboard or incident handling system for an agent to assess. The agent analyzes the event data and either dismisses it to the log or validates it and starts an incident case.
Alarm — the event is automatically classified as critical, and a priority alarm is raised. This might mean emailing an incident handler or sending a text message.
Alert tuning is necessary to reduce the incidence of false positives. False positive alerts and alarms waste analysts' time and lower productivity. Alert fatigue is when analysts are so consumed with dismissing numerous low-priority alerts that they miss a single high-impact alert that could have prevented a data breach. Analysts can become more preoccupied with looking for a quick reason to dismiss an alert than with adequately evaluating the alert. Reducing false positives is difficult, however, firstly because there is not a simple dial to turn for overall sensitivity and secondly because reducing the number of rules that produce alerts increases the risk of false negatives.

There is also a concept of true negatives. This is a measure of events that the system has properly allowed. Metrics for false and true negatives can be used to assess the performance of the alerting system.

Some of the techniques used to manage alert tuning include the following:

Refining detection rules and muting alert levels — If a particular rule generates multiple dashboard notifications, the rule's parameters can be adjusted to reduce this, perhaps by adding more correlation factors. Alternatively, the alert can be muted to log-only status or configured only to produce a single notification for every 10 or 100 events.
Redirecting sudden alert "floods" to a dedicated group — Changes in the network can cause a rule to produce far more alerts than it should. Once confirmed that this is a false positive, rather than "spamming" each analyst’s dashboard, it can be assigned to a dedicated agent or team to remediate.
Redirecting infrastructure-related alerts to a dedicated group — Misconfigurations, such as deviance from a baseline, can cause continually high alert volumes. While these are important to fix, that is not the job of the incident response team and is better managed by an infrastructure team.
Continuous monitoring of alert volume and analyst feedback — Managers should oversee the system and be aware of risks from alert fatigue. The experience of individual analysts can be utilized to reduce alert sensitivity, change the parameters of a given rule, or automate the processing of the rule using a SOAR solution.
Deploying machine learning (ML) analysis — ML can rapidly analyze the data sets produced by SIEM. It can be used to monitor how analysts respond to alerts and attempt to automatically tune the ruleset to reduce false negatives without impacting true positives.
