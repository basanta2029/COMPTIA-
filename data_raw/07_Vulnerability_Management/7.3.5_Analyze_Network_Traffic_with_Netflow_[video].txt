Transcript




close interactive script
Click one of the buttons to take you to that part of the video.
1. Configure Netflow on pfsense
00:04
NetFlow is a network protocol
00:06
system originally created by Cisco.
00:09
Netflow collects active IP network traffic
00:11
as it flows in or out of an interface.
00:13
The data is gathered and then analyzed to create a
00:16
picture of network traffic flow and the volume of traffic.<br>
00:19
So, why do we use Netflow?
00:21
Well the NetFlow protocol is used by IT professionals as a
00:24
network traffic analyzer to determine its point of origin,
00:28
it's destination, the volume and the paths on the network.
00:31
Before NetFlow's creation, network IT engineers and
00:34
administrators would use Simple Network Management Protocol
00:38
(SNMP) for network traffic analysis and monitoring.<br>
00:42
Although Netflow is a feature was created by Cisco,
00:44
there are open-source alternatives such as softflowd
00:47
that can be installed to work with pfsense.
00:49
This will allow us to capture network traffic and
00:53
create a picture to better analyze in and out traffic.<br>
2. Install softflowd
00:56
In order to use softflowd we must
00:58
install it from the package list.
01:00
To do so we need to go to system then package manager.
01:05
Tab over to Available packages.
01:08
Just to make it easier so were not scrolling for a while
01:11
type 'softflow' in the search bar and click search.
01:16
Next, we can click the Install button and then confirm.
01:19
When the software is installed
01:21
successfully, we can then configure it.<br>
3. Configure
01:25
To adjust our settings for softflowd we
01:27
need to go to services, then softflowd.
01:32
Make sure at the top it says enabled, Interface
01:35
can either be LAN or WAN depending on what side of
01:38
the firewall you would like to capture the data.
01:40
It is possible to grab data from both if you would
01:43
like however were just going to select WAN for now.
01:47
The Host will be the NetFlow analyzer which
01:49
happens to be '192.168.30.202' on our network.
01:54
Port will the designated port of your choosing.
01:57
Sometimes it is a good idea to use an alternative
01:59
port for security purposes, but for now were using
02:02
the standard '2055' port for NetFlow.
02:06
We will leave the max flows to the default '8192'.
02:10
The NetFlow version will depend
02:12
on your analyzer's capability.
02:14
If it doesn't support version ten then you
02:16
may want to see what version, it does support.
02:19
I'm going to flip this to version '9'
02:20
because that is what our analyzer supports.
02:23
Click save at the bottom.<br>
4. Verify
02:27
Even though our settings are saved we want
02:29
to make sure things are working right.
02:30
There is a command line command you can
02:32
run to show statistics on softflowd.
02:35
Go to diagnostics then command prompt.
02:39
In the Execute shell command field we can insert our command
02:42
'softflowctl -c /var/runsoftflowd.vmx0.ctl statistics'.
02:53
The part that has vmx0 may differ if your
02:56
network interface is labeled differently.
02:58
Execute that command and now we can see some results.
03:02
You may not a lot of traffic yet however
03:04
you may want to check back later to verify
03:07
flow packets and byte counts are going up.
03:09
Now we are ready to send and
03:11
configure NetFlow to our analyzer.<br>
5. summary
03:13
That is, it for this demo, in this demo
03:15
we installed and configured softflowd.<br>