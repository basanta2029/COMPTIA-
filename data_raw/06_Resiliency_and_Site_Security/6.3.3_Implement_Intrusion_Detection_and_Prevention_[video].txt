
Transcript




close interactive script
Click one of the buttons to take you to that part of the video.
1. Implement Intrusion Detection and Prevention
00:02
Intrusion detection and prevention is an important
00:05
task that is required to protect todays networks.
00:08
In this demonstration, we'll configured intrusion detection
00:11
and prevention using Snort on a pfSense security appliance.<br>
2. Choose an Intrusion Detection and Prevention Product
00:16
There are several products available that can do
00:17
both intrusion detection and intrusion prevention.
00:21
Some cost money and some are free.<br>
00:23
One of the most popular products is Snort.
00:25
Snort is a free, open source network intrusion detection
00:28
system (IDS) and intrusion prevention system (IPS).<br>
00:34
Although Snort is open source and free, it does
00:37
have some paid plans that you can subscribe to
00:39
and receive updates to rules faster.
00:41
In this demo, we'll configure Snort
00:43
on our pfSense security appliance.<br>
00:46
Before we configure Snort, let's
00:47
quickly look at the website.
00:49
As we scroll down, you see that you can manually download
00:52
Snort for various operating systems and distributions.
00:56
Snort is available for Fedora, Centos, FreeBSD and Windows.<br>
01:00
In the second step, you must get what is called an Oinkcode.
01:04
We will do that in a minute but
01:06
let's keep scrolling down this page.
01:08
Step 3 is to get updates.
01:09
We'll cover that later in the demo.<br>
01:12
Now as a review what we just talked about, Snort is
01:14
an open source intrusion prevention system capable
01:17
of real-time traffic analysis and packet logging.<br>
01:21
Snort is the most widely deployed IPS in the world.
01:23
There have been over 5 million downloads
01:26
and over 600 thousand registered users.<br>
3. Install Snort
01:29
To use Snort, you must first get an Oinkcode.
01:31
We'll go to our account.
01:32
Here is a link that says Oinkcode.
01:35
We already have a code generated, so we can proceed.
01:37
We will use the Oinkcode later.<br>
01:39
Now let's go to pfSense and install Snort.<br>
01:44
We've already logged into pfSense
01:45
and we're on the Dashboard.
01:47
Installing Snort on pfSense is quite easy.
01:50
It is done with the Package Manager
01:51
that is located under the System tab.
01:54
Once on the Package Manager page,
01:56
you click Available Packages.<br>
01:58
Now let's do a search for â€˜Snort'.
02:03
We have one result, so we'll come
02:04
down and click the Install link.
02:06
Now you can make sure you have the right package.
02:10
We do; so let's click Confirm to start the installation.<br>
02:14
Now we wait for a few minutes while Snort is installed.
02:16
When it does, the color changes from red to green and
02:19
it says that the installation successfully completed.
02:22
Down here on the bottom, a message says "Success".<br>
4. Configure Snort
02:25
Now that Snort is installed, we need to set it up.
02:29
Let's do that by going to Services and then down to Snort.
02:34
Be aware that this menu item for Snort
02:36
was not there until we installed it.
02:37
If you don't have this menu,
02:39
Snort probably is not installed.<br>
02:40
We will start by going to Global Settings.
02:43
Under Snort Subscriber Rules, we
02:45
check the Enable Snort VRT box.
02:48
VRT is an acronym for Vulnerability Research Team.<br>
02:52
Below that, next to Snort Oinkmaster
02:54
Code, we paste in the code.
02:56
Remember, we got the Oinkcode from the Snort website
02:59
that we were at in the beginning of the demo.
03:01
We copied the code to the clipboard and will
03:04
use a keyboard shortcut to paste it in here.<br>
03:06
Next, we Enable Snort GPLv2.
03:09
The Community Snort Rules fall under the GNU General
03:13
Public License Version 2, which encourages the
03:16
development and distribution of open source software.
03:18
This ruleset is 30 days behind
03:21
the Snort Subscriber Rule Set.
03:22
It does not contain zero-day threats under the limited
03:25
provision of the Snort Subscriber Rule Set License.<br>
03:29
Now let's check Enable ET Open (ET
03:32
is the acronym for Emerging Threats).
03:34
This downloads the Emerging Threats Open rules.
03:37
The ET Open Ruleset is an anti-malware IDS/IPS ruleset
03:42
that enables users with cost constraints to enhance
03:46
their existing network-based malware detection.<br>
03:49
We do not pay for the Emerging Threat
03:51
Pro rules, so we won't check that box.<br>
03:54
Let's skip down here under Sourcefire OpenAppID Detectors.
03:58
Let's check the Enable OpenAppID box.
04:01
Below that, check the box next to Enable RULES Open AppID.
04:04
OpenAppID is an application-focused detection
04:09
language and processing module for Snort.
04:12
When you use OpenAppID with pfSense, the system
04:15
can successfully detect (if configured to do so)
04:18
and block over 2600 different services like
04:21
Facebook, Netflix, Twitter, and Reddit.<br>
04:23
For our Rules Update Settings, we
04:25
set the Update Interval to 1 Day.
04:28
For our Update time, we set it to 2:00 AM.
04:32
Let's check the Hide Deprecated Rules Categories box.
04:35
This removes old and outdated rules.<br>
04:38
Under General Settings &gt; Remove Blocked
04:41
hosts Interval, we change that to 1 Hour.
04:43
Now you might think that we should block hosts forever
04:46
if they are malicious, but the problem is that often
04:49
these are coming from spoofed IP addresses or from
04:52
addresses that may be used by legitimate users very soon.
04:54
So, we will block only for 1 hour.<br>
04:57
We'll check the box for Startup/Shutdown Logging.
05:00
We want to know who and when Snort
05:02
is being started and stopped by.<br>
05:04
That wraps up everything for this page.
05:06
We'll click Save.<br>
5. Assign Rules to Wide Area Network (WAN) Interface
05:08
Now that we have the rules figured out, we need
05:10
to assign these rules to the WAN interface.
05:13
We'll go to the Snort Interfaces tab.
05:15
Then come down here to the right and click the Add link.<br>
05:19
Under General Settings, we want to make
05:21
sure that Enable Interface is checked.
05:22
We see that it is.
05:24
Make sure you have WAN selected under Interface.
05:27
This is the traffic we want to inspect.
05:29
For Description, we enter WAN.
05:31
We want to keep it obvious and simple here.<br>
05:34
Under Alert Settings, we check the
05:36
box to Send Alerts to System Log.
05:38
This will send alerts to the firewall log.<br>
05:41
We check the Block Offenders box.
05:43
If an offender creates a Snort alert, they will be blocked.
05:46
For the IP to Block, we block the Source IP address.<br>
05:52
There is nothing more we want to do here.
05:53
We'll come down and click Save.<br>
05:58
Now we want to check the box to enable the WAN interface.
06:00
Under Snort Status, click Runto start Snort.<br>
6. Summary
06:04
That's it for this demo.
06:05
In this demo we configured intrusion detection and
06:07
prevention using Snort on our pfSense security appliance.<br>